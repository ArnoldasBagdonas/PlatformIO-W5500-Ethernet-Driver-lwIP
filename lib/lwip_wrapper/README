# lwIP Library Porting Guide (Bare Metal)

This folder contains the lwIP TCP/IP stack integrated into the project with minimal PlatformIO configuration.

---

## Bare Metal Porting Overview

When porting lwIP to a bare-metal environment (no operating system), you need to implement several platform-specific system files to provide:

- **Time functions** (e.g., `sys_now()`)
- **Interrupt protection** (critical section control)
- **Thread and synchronization primitives** (if applicable)
- **Memory management hooks** (optional)

This project uses the **NO_SYS=1** configuration, disabling OS features and requiring minimal system stubs.

---

## Provided Dummy Port Files

To get started, basic dummy implementations are provided in the `port/` subfolder:

- `sys_arch.c` and `sys_arch.h`: Minimal critical section and timing stubs
- `sys.c` and `sys.h`: Thread and mailbox stubs (return errors as threading is disabled)
- `lwipopts.h`: lwIP options to disable OS support and enable raw API

These files act as placeholders and must be replaced or extended with actual hardware-specific code during porting.

---

## Folder Structure for Port Files

The recommended folder structure inside `lib/lwip_wrapper/` is:
```
lib/
└── lwip_wrapper/
    └── port/
        ├── src/           <-- lwIP core source files (e.g. sys_arch.c, ethernetif.c)
        └── include/       <-- lwIP headers and lwipopts.h
            ├── arch/   <-- port-specific headers (e.g. cc.h, perf.h, sys_arch.h)
            └── lwipopts.h
```

## Next Steps

1. Implement `sys_now()` using a hardware timer or system tick.
2. Provide interrupt disable/enable functions in `sys_arch_protect()` and `sys_arch_unprotect()`.
3. Adapt or implement threading and synchronization if your project evolves to use OS features.
4. Adjust `lwipopts.h` to fit your project needs.

---

For more details, see the [lwIP Bare Metal Porting Guide](https://lwip.fandom.com/wiki/Porting_For_Bare_Metal).

---

*This README will be updated as porting progresses.*

References:
https://lwip.fandom.com/wiki/Special:AllPages

https://lwip.fandom.com/wiki/Porting_For_Bare_Metal